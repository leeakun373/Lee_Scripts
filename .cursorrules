# Cursor AI 规则配置 - Lee Scripts 项目

## 项目信息
- **项目名称**: Lee REAPER Scripts
- **GitHub 仓库**: https://github.com/leeakun373/Lee_Reaper_Scripts
- **本地路径**: `C:\Users\DELL\AppData\Roaming\REAPER\Scripts\Lee_Scripts`
- **主要语言**: Lua (REAPER Scripts)

## 版本控制规则

### 当用户请求版本控制操作时：

1. **提交修改前必须**:
   - 检查 Git 状态 (`git status`)
   - 显示将要提交的文件列表
   - 确认提交信息清晰明确

2. **提交信息格式**:
   - **必须使用英文**（避免中文乱码问题）
   - 格式: `类型: 简短描述` 或 `类型: 简短描述\n\n详细说明`
   - 类型: feat/fix/docs/refactor/style/test/perf
   - 示例: 
     - `feat: Add new Marker workstation feature`
     - `fix: Fix button failure issue after language switching`
     - `docs: Update README and cursor rules`
     - `refactor: Restructure directory organization`
     - `Release v1.1.8: Full internationalization support`

3. **推送前必须**:
   - 先执行 `git pull origin master --no-edit` 确保同步
   - 检查是否有冲突
   - 如果有合并提交，确认合并正确
   - 确认所有修改都已提交

4. **自动执行的操作**:
   - 当用户明确要求提交时，自动执行:
     - `git add [文件路径]` 或 `git add .`（根据用户需求）
     - `git commit -m "提交信息"`
     - `git pull origin master --no-edit`（先拉取远程更改）
     - `git push origin master`（推送）
   - 如果推送失败，提供解决方案
   - 如果 pull 后有冲突，帮助解决冲突后再推送

5. **PowerShell 命令语法**:
   - 使用分号 `;` 连接多个命令，不使用 `&&`
   - 示例: `cd "path"; git status` 而不是 `cd "path" && git status`
   - 对于需要切换目录的操作，使用: `cd "path"; [命令]`

5. **分支管理**:
   - 默认使用 `master` 分支
   - 大功能开发建议创建新分支
   - 分支命名: `feature/功能名称` 或 `fix/问题描述`

## 代码规范

### Lua 脚本规范
- 使用 2 空格缩进
- 函数名使用驼峰命名: `functionName`
- 变量名使用驼峰命名: `variableName`
- 常量使用大写: `CONSTANT_NAME`
- 添加必要的注释，特别是复杂逻辑

### 文件命名规范
- 格式: `Lee_[分类] - [功能描述].lua`
- 分类: Items/Tracks/Takes/Markers/Main/Workflow/Utils
- 示例: `Lee_Items - Split at Time Selection.lua`

### 目录结构
- `Items/` - Items 相关操作
- `Tracks/` - Tracks 相关操作
- `Takes/` - Takes 相关操作
- `Markers/` - Markers 相关操作
- `Main/` - 主要工作流脚本
- `test/` - 测试脚本
- `Doc/` - 文档目录

## 文档管理

### 文档位置
- 项目文档: `Doc/` 目录
- 主 README: 根目录 `README.md`
- 版本控制指南: `Doc/VERSION_CONTROL_GUIDE.md`
- 维护文档: `Doc/MAINTENANCE.md`

### 文档更新规则
- 修改脚本后，如需要更新文档
- 文档使用 Markdown 格式
- 保持文档与代码同步

## 工作流程

### 开发新功能
1. 在 `test/` 目录创建测试脚本
2. 测试通过后移至对应分类目录
3. 更新 `README.md` 添加脚本说明
4. 提交并推送

### 修改现有脚本
1. 直接修改对应目录的脚本
2. 测试功能正常
3. 提交修改并推送

### 文档更新
1. 修改相关文档
2. 提交时使用 `docs:` 类型
3. 推送到远程仓库

## ReaPack Changelog 管理规则

### Changelog 格式（参考 FXMiner 项目）
- **必须使用 `@changelog` 标签**：ReaPack 可以直接读取此标签
- **位置**：在 `@version` 之后，`@about` 之前
- **格式**：每行以 `+` 开头，简洁描述改动
- **语言**：使用英文（与提交信息一致）

### Changelog 示例格式：
```lua
-- @version 1.1.11
-- @changelog
--   + Fixed window position stability: unified anchor system prevents position drift
--   + Implemented logic freeze mechanism: 3-frame suppression prevents ghosting
--   + Fixed rendering artifacts: switched from PathFillConvex to PathStroke
--   + Improved drag-and-drop: fixed payload format for string-based command IDs
--   + Enhanced preset creation: blank presets now default to 3 sectors
--   + Default settings: animation disabled by default, sector expansion enabled
-- @about Powerful customizable radial menu tool for REAPER
```

### 当推送更新到 GitHub 时：
1. **自动更新版本号**：
   - 更新 `@version` 标签
   - 更新代码中的 `VERSION` 变量
   - 更新 `config_defaults.lua` 中的 `CONFIG_SCHEMA_VERSION` 和 `version`

2. **自动更新 Changelog**：
   - 在 header 中添加或更新 `@changelog` 标签
   - 根据本次修改内容，以 `+` 开头逐行列出改动
   - 保持简洁，一行一个改动点
   - 使用英文描述

3. **更新顺序**：
   - 先更新版本号
   - 再更新 changelog
   - 最后提交并推送

### 特殊项目规则（RadialMenu_Tool）：
- 主入口文件：`Lee_RadialMenu.lua`
- 配置文件：`src/config_defaults.lua`
- 两个文件都需要更新版本号
- 只在主入口文件的 header 中添加 `@changelog`

## 特殊指令

### 当用户说"提交"、"推送"、"版本控制"时:
- 自动检查 Git 状态
- 显示修改的文件
- 询问或自动生成提交信息（**必须使用英文**）
- 执行提交和推送操作

### 当用户说"查看状态"、"Git 状态"时:
- 执行 `git status`
- 执行 `git log --oneline -5` 显示最近 5 次提交
- 显示当前分支信息

### 当用户说"同步"、"拉取"时:
- 执行 `git pull origin master --no-edit`
- 检查是否有冲突
- 如有冲突，提供解决方案
- 如果有合并提交，确认合并正确

## 注意事项

1. **不要强制推送** (`git push --force`) 除非用户明确要求
2. **不要删除未提交的修改** 除非用户明确要求
3. **提交前确认** 用户确实想要提交这些修改
4. **推送前同步** 确保先拉取远程更新
5. **提交信息使用英文** 所有提交信息必须使用英文，避免中文乱码问题
6. **提示信息** 与用户交互的提示信息可以使用中文

## 错误处理

### 如果推送失败:
1. 先执行 `git pull origin master --no-edit` 拉取远程更改
2. 如果有冲突，解决冲突后再次提交
3. 检查网络连接
4. 检查身份验证（可能需要 PAT token）
5. 如果远程有新的提交，pull 后会自动合并，然后再次推送
6. 提供具体的解决方案

### 如果有冲突:
1. 显示冲突文件
2. 解释冲突原因
3. 提供解决步骤
4. 帮助用户解决冲突

---

**配置日期**: 2024-11-18
**最后更新**: 2025-01-20
**重要变更**: 
- 提交信息必须使用英文（避免中文乱码）
- 添加 ReaPack Changelog 管理规则（参考 FXMiner 项目）
**适用版本**: Cursor AI 所有版本


